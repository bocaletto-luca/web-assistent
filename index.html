<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Universal Web Assistant</title>
  <meta name="description" content="Universal Web Assistant: a responsive, bilingual chat interface backed by JSON phrase libraries.">
  <link rel="canonical" href="https://your-domain.com/index.html">

  <!-- Open Graph -->
  <meta property="og:title" content="Universal Web Assistant">
  <meta property="og:description" content="Responsive bilingual chat assistant powered by JSON phrase files.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://your-domain.com/index.html">
  <meta property="og:site_name" content="web-assistent">
  <meta property="og:locale" content="en_US">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Universal Web Assistant">
  <meta name="twitter:description" content="Responsive bilingual chat assistant powered by JSON phrase files.">

  <!-- JSON-LD -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "Universal Web Assistant",
    "url": "https://your-domain.com/index.html",
    "author": {
      "@type": "Person",
      "name": "Bocaletto Luca",
      "url": "https://github.com/bocaletto-luca"
    }
  }
  </script>

  <style>
    /* Base Reset */
    *, *::before, *::after {
      margin: 0; padding: 0; box-sizing: border-box;
    }
    html { font-size: 16px; }
    body {
      font-family: 'Segoe UI', sans-serif;
      line-height: 1.5;
      background-color: #fafafa;
      color: #222;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    /* Containers */
    header, footer { background: #0066cc; color: #fff; }
    .container {
      width: 100%;
      max-width: 800px;
      margin: 0 auto;
      padding: 0 1rem;
    }

    /* Header */
    header {
      padding: 1rem 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    header h1 { font-size: 1.25rem; }
    #langToggle {
      background: transparent;
      border: 2px solid #fff;
      color: #fff;
      padding: 0.25em 0.75em;
      font-size: 0.9rem;
      border-radius: 4px;
      cursor: pointer;
    }

    /* Main Chat Area */
    main {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1rem 0;
    }
    .chat-box {
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      width: 100%;
      max-width: 600px;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      height: 70vh;
    }
    .messages {
      flex: 1;
      padding: 1rem;
      overflow-y: auto;
    }
    .message {
      margin-bottom: 0.75rem;
      max-width: 80%;
      word-wrap: break-word;
    }
    .message.user {
      align-self: flex-end;
      background: #e0f0ff;
      color: #004a8f;
      border-radius: 12px 12px 0 12px;
      padding: 0.5rem 0.75rem;
    }
    .message.bot {
      align-self: flex-start;
      background: #f1f1f1;
      color: #333;
      border-radius: 12px 12px 12px 0;
      padding: 0.5rem 0.75rem;
    }
    .chat-input {
      display: flex;
      border-top: 1px solid #ddd;
    }
    .chat-input input {
      flex: 1;
      border: none;
      padding: 0.75rem;
      font-size: 1rem;
    }
    .chat-input button {
      background: #0066cc;
      color: #fff;
      border: none;
      padding: 0 1rem;
      cursor: pointer;
    }

    /* Footer */
    footer {
      text-align: center;
      padding: 0.75rem 0;
      font-size: 0.9rem;
    }
    footer a { color: #ffe; text-decoration: underline; }

    /* Responsive */
    @media (max-width: 480px) {
      header h1 { font-size: 1rem; }
      .chat-box { height: 60vh; }
    }
  </style>
</head>

<body>
  <header>
    <div class="container">
      <h1 id="appTitle">Universal Web Assistant</h1>
      <button id="langToggle">IT</button>
    </div>
  </header>

  <main>
    <div class="chat-box container">
      <div class="messages" id="messages" role="log" aria-live="polite"></div>
      <form class="chat-input" id="chatForm">
        <input
          type="text"
          id="userInput"
          placeholder="Type your question…"
          aria-label="Chat input"
          autocomplete="off"
          required
        >
        <button type="submit" id="sendBtn">Send</button>
      </form>
    </div>
  </main>

  <footer>
    <div class="container">
      © 2023 Bocaletto Luca • <a href="https://github.com/bocaletto-luca/web-assistent" target="_blank">GitHub</a> • MIT License
    </div>
  </footer>

  <script>
    // --- i18n Dictionaries ---
    const DICTS = {
      en: {
        title: 'Universal Web Assistant',
        placeholder: 'Type your question…',
        send: 'Send',
        fallback: "Sorry, I don't understand. Try another phrase.",
        toggleLabel: 'IT'
      },
      it: {
        title: 'Assistente Universale Web',
        placeholder: 'Scrivi la tua domanda…',
        send: 'Invia',
        fallback: "Scusa, non ho capito. Prova un'altra frase.",
        toggleLabel: 'EN'
      }
    };

    let locale = 'en';
    let phrases = {};

    // --- DOM References ---
    const appTitle    = document.getElementById('appTitle');
    const langToggle  = document.getElementById('langToggle');
    const chatForm    = document.getElementById('chatForm');
    const userInput   = document.getElementById('userInput');
    const sendBtn     = document.getElementById('sendBtn');
    const messages    = document.getElementById('messages');

    // --- Load JSON Library ---
    async function loadPhrases() {
      try {
        const res = await fetch(`${locale}.json`, { cache: 'no-store' });
        phrases = await res.json();
      } catch (e) {
        console.error('Failed to load', locale + '.json', e);
        phrases = {};
      }
    }

    // --- Render UI Text ---
    function updateUIText() {
      appTitle.textContent          = DICTS[locale].title;
      userInput.placeholder         = DICTS[locale].placeholder;
      sendBtn.textContent           = DICTS[locale].send;
      langToggle.textContent        = DICTS[locale].toggleLabel;
    }

    // --- Switch Language ---
    langToggle.addEventListener('click', async () => {
      locale = locale === 'en' ? 'it' : 'en';
      document.documentElement.lang = locale;
      await loadPhrases();
      updateUIText();
      messages.innerHTML = ''; // clear chat when switching
    });

    // --- Append Message ---
    function appendMessage(text, who) {
      const msg = document.createElement('div');
      msg.className = 'message ' + who;
      msg.textContent = text;
      messages.appendChild(msg);
      messages.scrollTop = messages.scrollHeight;
    }

    // --- Handle Form Submit ---
    chatForm.addEventListener('submit', e => {
      e.preventDefault();
      const query = userInput.value.trim();
      if (!query) return;
      appendMessage(query, 'user');

      const key = query.toLowerCase();
      const entry = phrases[key];
      const reply = entry
        ? entry.response
        : DICTS[locale].fallback;

      setTimeout(() => appendMessage(reply, 'bot'), 300);
      userInput.value = '';
      userInput.focus();
    });

    // --- Init ---
    (async () => {
      document.documentElement.lang = locale;
      await loadPhrases();
      updateUIText();
    })();
  </script>
</body>
</html>
